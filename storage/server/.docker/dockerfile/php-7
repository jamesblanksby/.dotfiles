FROM php:7.1-apache

RUN apt-get update

RUN docker-php-ext-install \
	mysqli \
    pdo \
    pdo_mysql

RUN apt-get install -y --no-install-recommends \
	libfreetype6-dev \
	libjpeg62-turbo-dev \
	libmcrypt-dev \
	libpng-dev
RUN docker-php-ext-configure \
	gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/
RUN docker-php-ext-install \
    gd

RUN a2enmod \
	headers \
	rewrite

RUN { \
    echo "error_log=/dev/stderr"; \
    echo "log_errors=1"; \
    echo "memory_limit=512M"; \
    echo "output_buffering=4096"; \
    echo "post_max_size=128M"; \
    echo "upload_max_filesize=128M"; \
} > "$PHP_INI_DIR/conf.d/dockerfile.ini"
